# Hugging Face Spaces

## 2025-01-08

- ( 2025-01-08 23:41:26 )
- 緣起：
  - 最近看到  https://huggingface.co/spaces/vizro/demo-kpi 的 Data Visualization App 覺得很特別，先前多半只看到 Gradio 或 Streamlit 寫的界面，怎麼也可以跑 Vizro 呢？
- 參考：
  - https://huggingface.co/docs/hub/spaces-overview
  - 文件中提到：
    For step-by-step tutorials to creating your first Space, see the guides below:
    - [Creating a Gradio Space](https://huggingface.co/docs/hub/spaces-sdks-gradio)
    - [Creating a Streamlit Space](https://huggingface.co/docs/hub/spaces-sdks-streamlit)
    - [Creating a Docker Space](https://huggingface.co/docs/hub/spaces-sdks-docker-first-demo)
  - 所以看起來可以拿 Hugging Face Space 來跑我寫的 HPT Chatbot (powered by [`Chainlit`](https://docs.chainlit.io/get-started/overview))
- 研究了一下 `vizro/demo-kpi` 的原始碼，就更清楚答案了 -- **Docker**
```bash
jazzw@JazzBook:~/git/demo-kpi$ git remote -v
origin  https://huggingface.co/spaces/vizro/demo-kpi (fetch)
origin  https://huggingface.co/spaces/vizro/demo-kpi (push)
jazzw@JazzBook:~/git/demo-kpi$ tree
.
├── app.py
├── assets
│   ├── css
│   │   └── custom.css
│   ├── favicon.ico
│   └── images
│       ├── app.svg
│       └── logo.svg
├── Dockerfile
├── images
│   └── kpi-dashboard.gif
├── README.md
├── requirements.in
├── requirements.txt
└── utils
    ├── __init__.py
    ├── _charts.py
    └── _helper.py

6 directories, 13 files
```
- 學習點一：`uv pip compile requirements.in -o requirements.txt`
```bash
jazzw@JazzBook:~/git/demo-kpi$ cat requirements.txt
# This file was autogenerated by uv via the following command:
#    uv pip compile requirements.in -o requirements.txt
```
- 學習點二： 
  - `Dockerfile` EXPOSE `7860` port，可是誰去啟動 Docker 的呢？又如何呈現在 Hugging Face Space 頁面上呢？
  - 作者寫了很好的註解：請看 https://huggingface.co/docs/hub/spaces-sdks-docker
```bash
jazzw@JazzBook:~/git/demo-kpi$ cat Dockerfile
# read the doc: https://huggingface.co/docs/hub/spaces-sdks-docker
# you will also find guides on how best to write your Dockerfile

FROM python:3.12

RUN useradd -m -u 1000 user

WORKDIR /app

COPY --chown=user ./requirements.txt requirements.txt

RUN pip install --no-cache-dir --upgrade -r requirements.txt

COPY --chown=user . /app

EXPOSE 7860

CMD ["gunicorn", "-w", "4", "-b", "0.0.0.0:7860", "app:server"]
```